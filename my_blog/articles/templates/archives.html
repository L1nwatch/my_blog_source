{% extends "base.html" %}

{% block sidebar_content %}
    {% include "sidebar.html" %}
{% endblock %}

{% block head_title %}
    {% include "title.html" %}
{% endblock %}

{% block content %}
    <div class="posts">
        {% if error %}
            <h2 class="post-title">{{ error }}</h2>
        {% else %}
            {% for post in post_list %}
                <section class="post">
                    <header class="post-header">
                        <h2 class="post-title">
                            <a id="id_article_title" href="{% url 'detail' article_id=post.id %}">{{ post.title }}</a>
                        </h2>

                        {% include "article_info.html" %}
                    </header>
                </section>
            {% endfor %}
        {% endif %}
    </div>
{% endblock %}

{% block my_custom_js %}
    <!-- 以下是处理频繁点击的 js -->
    <script language="javascript" type="text/javascript">
        // ajax 相关代码
        $(document).ready(function () {
            $("#id_update_notes").click(function () {
                $.ajax({
                    type: "get",
                    url: "{% url "update_notes_check" %}",
                    success: function (result) {
                        if (result == "Yes") {
                            window.location.href = "{% url 'update_notes' %}";
                        } else {
                            alert("[-] 操作频繁, 现在无法执行更新操作");
                        }
                    }
                });
            });
        });
    </script>
{% endblock %}